(()=>{"use strict";var e={cards:[],likedCardsId:[],page:0,limit:10,logMode:!1},t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.logMode&&(console.log(t),console.log(e))},r=function(t){var r=e.cards.find((function(e){return e.id==t}));return void 0!==r&&r},n=function(e,t){var r=Array.from(t.childNodes).find((function(t){return t.id==e}));return void 0!==r&&r},o={baseUrl:"https://api.thecatapi.com/v1/",headers:{"x-api-key":"live_sHTJFxrUksyPzxBgrAtRU2t5aiCqI4ZN9SZBwwoDQ7IgmUCwKTh9xdTyaTmHY3HO","Content-Type":"application/json"}},a=function(e){return e.ok?e.json():Promise.reject(e.status)},i=function(e,t,r){var n=e.querySelector(".card").cloneNode(!0),o=n.querySelector(".card__image"),a=n.querySelector(".card__like-button");return n.id=t.id,o.src=t.url,o.setAttribute("alt","Котик"),t.like&&n.classList.add("like"),a.addEventListener("click",(function(){return r(t.id)})),n},c=new CustomEvent("activeTab",{detail:{tabId:""},bubbles:!0,cancelable:!0,composed:!1});function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var d,f,p=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"update",value:function(e,t){Array.isArray(t)?localStorage.setItem(e,t.join(this.separator)):localStorage.setItem(e,t)}},{key:"append",value:function(e,t){var r=localStorage[e]?localStorage[e]+",":"";Array.isArray(t)?localStorage.setItem(e,r+t.join(this.separator)):localStorage.setItem(e,r+t)}},{key:"get",value:function(e){return localStorage[e]?localStorage[e].split(this.separator):[]}},{key:"removeItem",value:function(e,t){if(localStorage[e]){var r=localStorage[e].split(this.separator);if(r.includes(t)){var n=r.findIndex((function(e){return e===t}));r.splice(n,1)}this.update(e,r)}}},{key:"clear",value:function(){localStorage.clear()}}],null&&u(e.prototype,null),t&&u(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e,t,r){var n;return n=function(e,t){if("object"!=y(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==y(n)?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}d=p,(f=s(f="separator"))in d?Object.defineProperty(d,f,{value:",",enumerable:!0,configurable:!0,writable:!0}):d[f]=",";var m=document.querySelector("#card-template").content,g=document.querySelector("#allCats .gallary__list"),h=document.querySelector("#favouriteCats .gallary__list"),S=document.querySelectorAll(".tab"),k=document.querySelectorAll(".nav__button"),j=function(r){!function(r,n){e.likedCardsId.splice(e.likedCardsId.indexOf(r),1),t("stateLikeDeleteById")}(r);var o=n(r,h);o&&o.remove(o)};function O(o){var a=document.querySelector('[id="'.concat(o,'"]'));a.classList.toggle("like"),function(r,n){t("stateCardLikeStatusToggle"),e.cards.find((function(e){return e.id==r})).like^=!0}(a.id),a.classList.contains("like")?function(o){!function(r,n){!e.likedCardsId.includes(r)&&(e.likedCardsId.push(r),t("stateLikePush"))}(o),!n(o,h)&&h.prepend(i(m,r(o),O))}(o):j(o)}k.forEach((function(e){return e.addEventListener("click",(function(e){return function(e,t,r){if(!e.classList.contains("active")){var n=e.getAttribute("data-tab");t.forEach((function(t){return t==e?t.classList.add("active"):t.classList.remove("active")})),r.forEach((function(e){return e.id==n?e.classList.add("active"):e.classList.remove("active")})),c.detail.tabId=n,document.dispatchEvent(c)}}(e.target,k,S)}))})),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return fetch("".concat(o.baseUrl,"images/search?limit=").concat(e,"&page=").concat(t),{method:"GET",headers:o.headers}).then(a)}(e.limit,e.page).then((function(n){n.forEach((function(n){var o;r(n.id)||(o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({like:!1},n),!e.cards.includes(o)&&(e.cards.push(o),t("stateCardPush")),g.append(i(m,n,O)))}))}));var w=function(e){!r(e.id)&&g.append(i(m,e,O))};document.addEventListener("activeTab",(function(t){var o;switch(t.detail.tabId){case"allCats":e.cards.forEach(w);break;case"favouriteCats":o=[],e.likedCardsId.forEach((function(e){var t=r(e);t&&o.push(i(m,t,O))})),o.forEach((function(e){!n(e.id,h)&&h.prepend(e)}))}}))})();